<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoCare - Neonatal Consultations</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #f5f7fa;
            min-height: 100vh;
            padding: 20px;
        }

        .app-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .tabs-container {
            display: flex;
            gap: 32px;
            border-bottom: 2px solid #e5e7eb;
            margin-bottom: 24px;
            margin-top: 20px;
        }

        .tab {
            padding: 12px 0;
            font-size: 15px;
            font-weight: 600;
            color: #6c757d;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            margin-bottom: -2px;
            transition: all 0.2s;
        }

        .tab.active {
            color: #2C3E50;
            border-bottom-color: #2C3E50;
        }

        .tab:hover {
            color: #2C3E50;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 32px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo h1 {
            color: #2C3E50;
            font-size: 32px;
            margin-bottom: 8px;
        }

        .logo p {
            color: #6c757d;
            font-size: 14px;
        }

        .client-logo {
            width: 120px;
            height: auto;
            margin: 0 auto 24px;
            display: block;
        }

        .client-logo-small {
            height: 32px;
            width: auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: #ffffff;
        }

        input:focus {
            outline: none;
            border-color: #2C3E50;
        }

        .btn {
            width: 100%;
            padding: 14px;
            background: #2C3E50;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s, box-shadow 0.2s;
        }

        .btn:hover {
            background: #34495e;
            box-shadow: 0 4px 12px rgba(44, 62, 80, 0.3);
        }

        .btn:active {
            background: #1a252f;
        }

        .btn-secondary {
            background: white;
            color: #2C3E50;
            border: 2px solid #2C3E50;
            margin-top: 10px;
        }

        .btn-secondary:hover {
            background: #f5f7fa;
            box-shadow: 0 4px 12px rgba(44, 62, 80, 0.2);
        }

        .doctors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 30px;
        }

        .doctor-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .doctor-card:hover {
            border-color: #2C3E50;
            box-shadow: 0 2px 8px rgba(44, 62, 80, 0.1);
        }

        .doctor-card.selected {
            border-color: #2C3E50;
            background: #f8f9fa;
        }

        .doctor-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: #6c757d;
            margin: 0 auto;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .doctor-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .online-status {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 12px;
            height: 12px;
            background: #10b981;
            border: 2px solid white;
            border-radius: 50%;
        }

        .doctor-name {
            font-size: 16px;
            font-weight: 600;
            color: #2C3E50;
            text-align: center;
            margin: 0;
            line-height: 1.4;
        }

        .doctor-specialty {
            font-size: 13px;
            color: #6c757d;
            text-align: center;
            margin: 0;
            line-height: 1.4;
        }

        .doctor-info {
            display: flex;
            justify-content: space-around;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
            margin-top: 12px;
            gap: 16px;
        }

        .info-item {
            text-align: center;
            flex: 1;
        }

        .info-label {
            font-size: 11px;
            color: #9ca3af;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 13px;
            font-weight: 600;
            color: #2C3E50;
        }

        .price-tag {
            background: #4caf50;
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            display: inline-block;
            margin-top: 12px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .app-header {
            background: #2C3E50;
            color: white;
            padding: 16px 32px;
            margin: -20px -20px 20px -20px;
            border-radius: 8px 8px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .app-header h1 {
            font-size: 20px;
            font-weight: 600;
            margin: 0;
            color: white;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #2C3E50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .logout-btn {
            padding: 8px 16px;
            background: transparent;
            color: #2C3E50;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: #2C3E50;
            color: white;
            border-color: #2C3E50;
        }

        .payment-summary {
            background: #f5f5f5;
            padding: 24px;
            border-radius: 12px;
            margin: 24px 0;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .summary-row.total {
            font-size: 20px;
            font-weight: 600;
            color: #2C3E50;
            padding-top: 12px;
            border-top: 2px solid #ddd;
            margin-top: 12px;
        }

        .stripe-form {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .card-element {
            background: white;
            padding: 12px;
            border-radius: 6px;
            border: 2px solid #e0e0e0;
            margin-bottom: 16px;
        }

        .video-container {
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 24px;
            position: relative;
            height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .video-placeholder {
            color: white;
            text-align: center;
        }

        .video-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 12px;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 2px solid white;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .control-btn.end-call {
            background: #f44336;
            border-color: #f44336;
        }

        .control-btn.end-call:hover {
            background: #d32f2f;
        }

        .chat-panel {
            background: #f5f5f5;
            border-radius: 12px;
            padding: 20px;
            height: 300px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 16px;
        }

        .message {
            background: white;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
        }

        .message.doctor {
            background: #e3f2fd;
        }

        .message-sender {
            font-weight: 600;
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .chat-input-container {
            display: flex;
            gap: 8px;
        }

        .chat-input {
            flex: 1;
        }

        .send-btn {
            padding: 12px 24px;
            background: #2C3E50;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background: #4caf50;
            color: white;
            margin-left: 12px;
        }

        .back-btn {
            background: transparent;
            color: #2C3E50;
            border: 1px solid #d1d5db;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            margin-bottom: 20px;
            display: inline-block;
        }

        .back-btn:hover {
            background: #2C3E50;
            color: white;
            border-color: #2C3E50;
        }

        .toggle-text {
            text-align: center;
            margin-top: 20px;
            color: #666;
        }

        .toggle-link {
            color: #2C3E50;
            cursor: pointer;
            font-weight: 600;
            text-decoration: none;
        }

        .toggle-link:hover {
            text-decoration: underline;
        }

        .processing {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2C3E50;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background: #999;
            border-radius: 50%;
            animation: typingDot 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingDot {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-10px);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Mock doctors data
        const mockDoctors = [
            {
                id: 1,
                name: "Dr. Sarah Johnson",
                specialty: "Neonatal Intensive Care",
                experience: "12 years",
                rating: "4.9",
                price: 75,
                avatar: "üë©‚Äç‚öïÔ∏è"
            },
            {
                id: 2,
                name: "Dr. Michael Chen",
                specialty: "Pediatric Neonatology",
                experience: "15 years",
                rating: "4.8",
                price: 85,
                avatar: "üë®‚Äç‚öïÔ∏è"
            },
            {
                id: 3,
                name: "Dr. Emily Rodriguez",
                specialty: "Newborn Care Specialist",
                experience: "8 years",
                rating: "4.9",
                price: 70,
                avatar: "üë©‚Äç‚öïÔ∏è"
            },
            {
                id: 4,
                name: "Dr. James Wilson",
                specialty: "Neonatal Cardiology",
                experience: "20 years",
                rating: "5.0",
                price: 95,
                avatar: "üë®‚Äç‚öïÔ∏è"
            }
        ];

        function App() {
            const [currentView, setCurrentView] = useState('login');
            const [user, setUser] = useState(null);
            const [selectedDoctor, setSelectedDoctor] = useState(null);
            const [isProcessing, setIsProcessing] = useState(false);
            const [freeConsultations, setFreeConsultations] = useState(1);
            const [hasUsedFirstConsultation, setHasUsedFirstConsultation] = useState(false);
            const [hasSeenFirstPaywall, setHasSeenFirstPaywall] = useState(false);
            const [selectedPlan, setSelectedPlan] = useState(null);

            const handleDoctorSelect = (doc) => {
                setSelectedDoctor(doc);
                // If user has free consultations, go directly to consultation
                if (freeConsultations > 0) {
                    setCurrentView('consultation');
                } else {
                    // On second attempt and onwards, show offers page first
                    setCurrentView('offers');
                }
            };

            const handleEndConsultation = () => {
                // Decrement consultation count
                const remainingConsultations = freeConsultations - 1;
                setFreeConsultations(remainingConsultations);

                // If this was the first free consultation, show paywall
                if (freeConsultations === 1 && !hasUsedFirstConsultation) {
                    setHasUsedFirstConsultation(true);
                    setCurrentView('paywall');
                } else {
                    setCurrentView('doctors');
                }
                setSelectedDoctor(null);
            };

            const handlePaywallDismiss = (skipToCheckout = false) => {
                setHasSeenFirstPaywall(true);
                if (skipToCheckout) {
                    // User clicked "Continue to Checkout" - go straight to payment
                    // Set the default plan
                    const defaultPlan = { id: 1, name: 'Consultation Bundle', consultations: 10, price: 99 };
                    setSelectedPlan(defaultPlan);
                    setCurrentView('payment');
                } else {
                    // User clicked "Skip for Now" - go back to doctors hub
                    setCurrentView('doctors');
                }
            };

            const handlePlanSelect = (plan) => {
                setSelectedPlan(plan);
                setCurrentView('payment');
            };

            const views = {
                login: <LoginView onLogin={setUser} />,
                doctors: user ? <DoctorsView
                    user={user}
                    freeConsultations={freeConsultations}
                    onSelectDoctor={handleDoctorSelect}
                    onLogout={() => {
                        setUser(null);
                        setCurrentView('login');
                        setFreeConsultations(1);
                        setHasUsedFirstConsultation(false);
                        setHasSeenFirstPaywall(false);
                    }}
                /> : <LoginView onLogin={setUser} />,
                paywall: <PaywallView 
                    onDismiss={handlePaywallDismiss}
                    isFirstView={!hasSeenFirstPaywall}
                />,
                offers: <OffersView
                    doctor={selectedDoctor}
                    onSelectPlan={handlePlanSelect}
                    onBack={() => setCurrentView('doctors')}
                />,
                payment: <PaymentView
                    doctor={selectedDoctor}
                    plan={selectedPlan}
                    user={user}
                    onBack={() => {
                        // If came from paywall, go back to doctors hub, otherwise go to offers
                        if (hasSeenFirstPaywall && freeConsultations === 0) {
                            setCurrentView('doctors');
                        } else {
                            setCurrentView('offers');
                        }
                    }}
                    onPaymentComplete={() => {
                        // Capture values before state changes
                        const consultationsToAdd = selectedPlan ? selectedPlan.consultations : 0;

                        setIsProcessing(true);

                        setTimeout(() => {
                            // Update consultations count
                            setFreeConsultations(prev => prev + consultationsToAdd);
                            // Change view first
                            setCurrentView('doctors');
                            // Then stop processing
                            setIsProcessing(false);
                            // Clear selections after view change
                            setTimeout(() => {
                                setSelectedDoctor(null);
                                setSelectedPlan(null);
                            }, 100);
                        }, 2000);
                    }}
                />,
                consultation: <ConsultationView 
                    doctor={selectedDoctor} 
                    user={user} 
                    onEndCall={handleEndConsultation} 
                />
            };

            useEffect(() => {
                if (user && currentView === 'login') {
                    setCurrentView('doctors');
                }
            }, [user]);

            return (
                <div className="app-container">
                    {isProcessing ? (
                        <div className="card">
                            <div className="processing">
                                <div className="spinner"></div>
                                <h2>Processing Payment...</h2>
                                <p>Please wait while we confirm your booking</p>
                            </div>
                        </div>
                    ) : (views[currentView] || views['doctors'])}
                </div>
            );
        }

        function LoginView({ onLogin }) {
            const [isSignup, setIsSignup] = useState(false);
            const [email, setEmail] = useState('');
            const [password, setPassword] = useState('');
            const [name, setName] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                const userData = {
                    email,
                    name: isSignup ? name : email.split('@')[0],
                    id: Date.now()
                };
                onLogin(userData);
            };

            return (
                <div className="card" style={{ maxWidth: '500px', margin: '0 auto' }}>
                    <img
                        src="https://upload.wikimedia.org/wikipedia/commons/3/36/McDonald%27s_Golden_Arches.svg"
                        alt="McDonald's"
                        className="client-logo"
                    />
                    <div className="logo">
                        <h1>üë∂ NeoCare</h1>
                        <p>Expert Neonatal Care, Anytime</p>
                        <p style={{ fontSize: '12px', color: '#9ca3af', marginTop: '8px' }}>Powered by McDonald's Employee Benefits</p>
                    </div>
                    <h2 style={{ marginBottom: '24px', textAlign: 'center' }}>
                        {isSignup ? 'Create Account' : 'Welcome Back'}
                    </h2>
                    <form onSubmit={handleSubmit}>
                        {isSignup && (
                            <div className="form-group">
                                <label>Full Name</label>
                                <input 
                                    type="text" 
                                    placeholder="Enter your full name" 
                                    value={name}
                                    onChange={(e) => setName(e.target.value)}
                                    required 
                                />
                            </div>
                        )}
                        <div className="form-group">
                            <label>Email</label>
                            <input 
                                type="email" 
                                placeholder="Enter your email" 
                                value={email}
                                onChange={(e) => setEmail(e.target.value)}
                                required 
                            />
                        </div>
                        <div className="form-group">
                            <label>Password</label>
                            <input 
                                type="password" 
                                placeholder="Enter your password" 
                                value={password}
                                onChange={(e) => setPassword(e.target.value)}
                                required 
                            />
                        </div>
                        <button type="submit" className="btn">
                            {isSignup ? 'Sign Up' : 'Log In'}
                        </button>
                    </form>
                    <div className="toggle-text">
                        {isSignup ? 'Already have an account? ' : "Don't have an account? "}
                        <span className="toggle-link" onClick={() => setIsSignup(!isSignup)}>
                            {isSignup ? 'Log In' : 'Sign Up'}
                        </span>
                    </div>
                </div>
            );
        }

        function DoctorsView({ user, freeConsultations, onSelectDoctor, onLogout }) {
            const handleSelect = (doctor) => {
                // Immediately navigate when card is clicked
                onSelectDoctor(doctor);
            };

            return (
                <div className="card">
                    <div className="app-header">
                        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                            <img
                                src="https://upload.wikimedia.org/wikipedia/commons/3/36/McDonald%27s_Golden_Arches.svg"
                                alt="McDonald's"
                                className="client-logo-small"
                            />
                            <h1>üë∂ NeoCare</h1>
                        </div>
                        <div className="user-info">
                            <span style={{ color: 'white', marginRight: '12px' }}>{user.name}</span>
                            <button className="logout-btn" onClick={onLogout} style={{ background: 'transparent', color: 'white', borderColor: 'rgba(255,255,255,0.3)' }}>Logout</button>
                        </div>
                    </div>
                    <div style={{ padding: '0 8px' }}>
                    
                    {freeConsultations > 0 && (
                        <div style={{
                            background: '#10b981',
                            color: 'white',
                            padding: '14px 20px',
                            borderRadius: '8px',
                            marginBottom: '20px',
                            marginTop: '20px',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'space-between'
                        }}>
                            <div>
                                <div style={{ fontSize: '16px', fontWeight: '600' }}>You have {freeConsultations} FREE consultation{freeConsultations !== 1 ? 's' : ''} available</div>
                                <div style={{ fontSize: '13px', opacity: '0.9', marginTop: '4px' }}>Tienes {freeConsultations} consulta{freeConsultations !== 1 ? 's' : ''} disponible{freeConsultations !== 1 ? 's' : ''}</div>
                            </div>
                            <div style={{ fontSize: '32px', fontWeight: '700' }}>{freeConsultations}</div>
                        </div>
                    )}
                    
                    {freeConsultations === 0 && (
                        <div style={{
                            background: '#fff3cd',
                            color: '#856404',
                            padding: '14px 20px',
                            borderRadius: '8px',
                            marginBottom: '20px',
                            marginTop: '20px',
                            border: '1px solid #ffeaa7'
                        }}>
                            <div style={{ fontSize: '15px', fontWeight: '600' }}>‚ö†Ô∏è No free consultations remaining</div>
                            <div style={{ fontSize: '13px', marginTop: '4px' }}>Select a specialist to view payment options</div>
                        </div>
                    )}

                    <div className="tabs-container">
                        <div className="tab active">Disponibles</div>
                        <div className="tab">Finalizadas</div>
                    </div>

                    <div style={{ marginBottom: '16px' }}>
                        <div style={{ fontSize: '14px', color: '#6c757d' }}>Tienes {freeConsultations > 0 ? freeConsultations : 0} consultas disponibles</div>
                    </div>

                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#2C3E50', marginBottom: '16px' }}>Nueva consulta por chat</h3>
                    
                    <div className="doctors-grid">
                        {mockDoctors.map(doctor => (
                            <div
                                key={doctor.id}
                                className="doctor-card"
                                onClick={() => handleSelect(doctor)}
                            >
                                <div className="doctor-avatar">
                                    {doctor.avatar}
                                    <div className="online-status"></div>
                                </div>
                                <div className="doctor-name">{doctor.name}</div>
                                <div className="doctor-specialty">{doctor.specialty}</div>
                                <div className="doctor-info">
                                    <div className="info-item">
                                        <div className="info-label">Experience</div>
                                        <div className="info-value">{doctor.experience}</div>
                                    </div>
                                    <div className="info-item">
                                        <div className="info-label">Rating</div>
                                        <div className="info-value">‚≠ê {doctor.rating}</div>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>
                    </div>
                </div>
            );
        }

        function OffersView({ doctor, onSelectPlan, onBack }) {
            // Fixed plan structure (price configured per client)
            const fixedPlan = { id: 1, name: 'Consultation Bundle', consultations: 10, price: 99 };

            const handleContinue = () => {
                onSelectPlan(fixedPlan);
            };

            return (
                <div className="card" style={{ maxWidth: '600px', margin: '0 auto' }}>
                    <img
                        src="https://upload.wikimedia.org/wikipedia/commons/3/36/McDonald%27s_Golden_Arches.svg"
                        alt="McDonald's"
                        style={{ width: '80px', height: 'auto', margin: '0 auto 16px', display: 'block' }}
                    />
                    <button className="back-btn" onClick={onBack}>‚Üê Back to Specialists</button>

                    <div style={{ textAlign: 'center', marginBottom: '32px', marginTop: '32px' }}>
                        <div style={{ fontSize: '48px', marginBottom: '20px' }}>üë®‚Äç‚öïÔ∏è</div>
                        <h2 style={{ fontSize: '26px', marginBottom: '16px', color: '#2C3E50', fontWeight: '600', lineHeight: '1.3' }}>
                            You've Reached Your Free Consultation Limit
                        </h2>
                        <p style={{ color: '#6c757d', fontSize: '17px', lineHeight: '1.6', marginBottom: '28px', maxWidth: '480px', margin: '0 auto 28px' }}>
                            Continue your access to certified neonatal specialists available 24/7 for expert guidance whenever you need it.
                        </p>
                    </div>

                    {/* Value Proposition */}
                    <div style={{
                        background: '#f8f9fa',
                        padding: '24px',
                        borderRadius: '12px',
                        marginBottom: '32px',
                        border: '1px solid #e5e7eb'
                    }}>
                        <div style={{ marginBottom: '20px' }}>
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px', marginBottom: '16px' }}>
                                <div style={{ fontSize: '24px', flexShrink: 0 }}>‚úì</div>
                                <div>
                                    <div style={{ fontWeight: '600', color: '#2C3E50', fontSize: '15px', marginBottom: '4px' }}>
                                        24/7 Access to Specialists
                                    </div>
                                    <div style={{ color: '#6c757d', fontSize: '14px', lineHeight: '1.5' }}>
                                        Connect with certified neonatal care experts anytime, day or night
                                    </div>
                                </div>
                            </div>
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px', marginBottom: '16px' }}>
                                <div style={{ fontSize: '24px', flexShrink: 0 }}>‚úì</div>
                                <div>
                                    <div style={{ fontWeight: '600', color: '#2C3E50', fontSize: '15px', marginBottom: '4px' }}>
                                        Unlimited Questions
                                    </div>
                                    <div style={{ color: '#6c757d', fontSize: '14px', lineHeight: '1.5' }}>
                                        Ask as many questions as you need during each consultation
                                    </div>
                                </div>
                            </div>
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px' }}>
                                <div style={{ fontSize: '24px', flexShrink: 0 }}>‚úì</div>
                                <div>
                                    <div style={{ fontWeight: '600', color: '#2C3E50', fontSize: '15px', marginBottom: '4px' }}>
                                        Secure & Confidential
                                    </div>
                                    <div style={{ color: '#6c757d', fontSize: '14px', lineHeight: '1.5' }}>
                                        HIPAA-compliant platform with encrypted conversations
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Single CTA */}
                    <button
                        className="btn"
                        onClick={handleContinue}
                        style={{ marginBottom: '16px', fontSize: '16px', padding: '16px' }}
                    >
                        Continue to Checkout
                    </button>

                    <p style={{ textAlign: 'center', fontSize: '13px', color: '#9ca3af', marginTop: '16px' }}>
                        Secure payment ‚Ä¢ Cancel anytime ‚Ä¢ Promo codes accepted at checkout
                    </p>
                </div>
            );
        }

        function PaywallView({ onDismiss, isFirstView = true }) {
            return (
                <div className="card" style={{ maxWidth: '600px', margin: '0 auto' }}>
                    <img
                        src="https://upload.wikimedia.org/wikipedia/commons/3/36/McDonald%27s_Golden_Arches.svg"
                        alt="McDonald's"
                        style={{ width: '80px', height: 'auto', margin: '0 auto 16px', display: 'block' }}
                    />

                    <div style={{ textAlign: 'center', marginBottom: '32px', marginTop: '32px' }}>
                        <div style={{ fontSize: '48px', marginBottom: '20px' }}>üë®‚Äç‚öïÔ∏è</div>
                        <h2 style={{ fontSize: '26px', marginBottom: '16px', color: '#2C3E50', fontWeight: '600', lineHeight: '1.3' }}>
                            You've Reached Your Free Consultation Limit
                        </h2>
                        <p style={{ color: '#6c757d', fontSize: '17px', lineHeight: '1.6', marginBottom: '28px', maxWidth: '480px', margin: '0 auto 28px' }}>
                            Continue your access to certified neonatal specialists available 24/7 for expert guidance whenever you need it.
                        </p>
                    </div>

                    {/* Value Proposition */}
                    <div style={{
                        background: '#f8f9fa',
                        padding: '24px',
                        borderRadius: '12px',
                        marginBottom: '32px',
                        border: '1px solid #e5e7eb'
                    }}>
                        <div style={{ marginBottom: '20px' }}>
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px', marginBottom: '16px' }}>
                                <div style={{ fontSize: '24px', flexShrink: 0 }}>‚úì</div>
                                <div>
                                    <div style={{ fontWeight: '600', color: '#2C3E50', fontSize: '15px', marginBottom: '4px' }}>
                                        24/7 Access to Specialists
                                    </div>
                                    <div style={{ color: '#6c757d', fontSize: '14px', lineHeight: '1.5' }}>
                                        Connect with certified neonatal care experts anytime, day or night
                                    </div>
                                </div>
                            </div>
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px', marginBottom: '16px' }}>
                                <div style={{ fontSize: '24px', flexShrink: 0 }}>‚úì</div>
                                <div>
                                    <div style={{ fontWeight: '600', color: '#2C3E50', fontSize: '15px', marginBottom: '4px' }}>
                                        Unlimited Questions
                                    </div>
                                    <div style={{ color: '#6c757d', fontSize: '14px', lineHeight: '1.5' }}>
                                        Ask as many questions as you need during each consultation
                                    </div>
                                </div>
                            </div>
                            <div style={{ display: 'flex', alignItems: 'flex-start', gap: '12px' }}>
                                <div style={{ fontSize: '24px', flexShrink: 0 }}>‚úì</div>
                                <div>
                                    <div style={{ fontWeight: '600', color: '#2C3E50', fontSize: '15px', marginBottom: '4px' }}>
                                        Secure & Confidential
                                    </div>
                                    <div style={{ color: '#6c757d', fontSize: '14px', lineHeight: '1.5' }}>
                                        HIPAA-compliant platform with encrypted conversations
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Single CTA */}
                    <button
                        className="btn"
                        onClick={() => onDismiss(true)}
                        style={{ marginBottom: '16px', fontSize: '16px', padding: '16px' }}
                    >
                        Continue to Checkout
                    </button>

                    {isFirstView && (
                        <button
                            className="btn btn-secondary"
                            onClick={() => onDismiss(false)}
                            style={{ marginTop: '8px' }}
                        >
                            Skip for Now
                        </button>
                    )}

                    <p style={{ textAlign: 'center', fontSize: '13px', color: '#9ca3af', marginTop: '16px' }}>
                        Secure payment ‚Ä¢ Cancel anytime ‚Ä¢ Promo codes accepted at checkout
                    </p>
                </div>
            );
        }

        function PaymentView({ doctor, plan, user, onBack, onPaymentComplete }) {
            const [cardNumber, setCardNumber] = useState('');
            const [expiry, setExpiry] = useState('');
            const [cvc, setCvc] = useState('');
            const [name, setName] = useState(user.name);
            const [promoCode, setPromoCode] = useState('');
            const [showPromoCode, setShowPromoCode] = useState(false);

            const handleSubmit = (e) => {
                e.preventDefault();
                onPaymentComplete();
            };

            const totalAmount = plan ? plan.price : (doctor ? doctor.price + 5 : 80);

            return (
                <div className="card" style={{ maxWidth: '600px', margin: '0 auto' }}>
                    <img
                        src="https://upload.wikimedia.org/wikipedia/commons/3/36/McDonald%27s_Golden_Arches.svg"
                        alt="McDonald's"
                        style={{ width: '80px', height: 'auto', margin: '0 auto 16px', display: 'block' }}
                    />
                    <button className="back-btn" onClick={onBack}>‚Üê Back to Plans</button>

                    <div className="logo">
                        <h1>üë∂ NeoCare</h1>
                    </div>
                    
                    <h2>Complete Your Purchase</h2>
                    <p style={{ color: '#666', marginTop: '8px' }}>Secure payment powered by Stripe</p>

                    <div className="payment-summary">
                        {doctor && (
                            <div style={{ display: 'flex', alignItems: 'center', marginBottom: '16px', paddingBottom: '16px', borderBottom: '1px solid #ddd' }}>
                                <div className="doctor-avatar" style={{ width: '50px', height: '50px', fontSize: '20px' }}>
                                    {doctor.avatar}
                                </div>
                                <div style={{ marginLeft: '16px' }}>
                                    <div style={{ fontWeight: '600', fontSize: '16px' }}>{doctor.name}</div>
                                    <div style={{ color: '#666', fontSize: '13px' }}>{doctor.specialty}</div>
                                </div>
                            </div>
                        )}
                        
                        {plan && (
                            <div style={{ marginBottom: '16px' }}>
                                <div style={{ fontWeight: '600', fontSize: '18px', marginBottom: '8px', color: '#2C3E50' }}>
                                    {plan.name}
                                </div>
                                <div style={{ color: '#666', fontSize: '14px' }}>
                                    {plan.consultations} consultations with certified specialists
                                </div>
                            </div>
                        )}
                        
                        <div className="summary-row">
                            <span>{plan ? 'Plan Price' : 'Consultation Fee'}</span>
                            <span>${plan ? plan.price : doctor.price}.00</span>
                        </div>
                        {!plan && (
                            <div className="summary-row">
                                <span>Service Fee</span>
                                <span>$5.00</span>
                            </div>
                        )}
                        <div className="summary-row total">
                            <span>Total</span>
                            <span>${totalAmount}.00</span>
                        </div>
                    </div>

                    <form onSubmit={handleSubmit}>
                        <div className="stripe-form">
                            <h3 style={{ marginBottom: '16px', fontSize: '16px' }}>üí≥ Payment Details</h3>
                            
                            <div className="form-group">
                                <label>Card Number</label>
                                <input 
                                    type="text" 
                                    placeholder="4242 4242 4242 4242" 
                                    value={cardNumber}
                                    onChange={(e) => setCardNumber(e.target.value)}
                                    maxLength="19"
                                    required 
                                />
                            </div>
                            
                            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                                <div className="form-group">
                                    <label>Expiry Date</label>
                                    <input 
                                        type="text" 
                                        placeholder="MM/YY" 
                                        value={expiry}
                                        onChange={(e) => setExpiry(e.target.value)}
                                        maxLength="5"
                                        required 
                                    />
                                </div>
                                <div className="form-group">
                                    <label>CVC</label>
                                    <input 
                                        type="text" 
                                        placeholder="123" 
                                        value={cvc}
                                        onChange={(e) => setCvc(e.target.value)}
                                        maxLength="3"
                                        required 
                                    />
                                </div>
                            </div>
                            
                            <div className="form-group">
                                <label>Cardholder Name</label>
                                <input
                                    type="text"
                                    placeholder="Name on card"
                                    value={name}
                                    onChange={(e) => setName(e.target.value)}
                                    required
                                />
                            </div>

                            {/* Promo Code Section */}
                            <div style={{ marginTop: '20px', paddingTop: '20px', borderTop: '1px solid #e5e7eb' }}>
                                {!showPromoCode ? (
                                    <button
                                        type="button"
                                        onClick={() => setShowPromoCode(true)}
                                        style={{
                                            background: 'transparent',
                                            border: 'none',
                                            color: '#2C3E50',
                                            fontSize: '14px',
                                            fontWeight: '600',
                                            cursor: 'pointer',
                                            padding: '0',
                                            textDecoration: 'underline'
                                        }}
                                    >
                                        üéüÔ∏è Have a promo code?
                                    </button>
                                ) : (
                                    <div className="form-group" style={{ marginBottom: '0' }}>
                                        <label>Promo Code</label>
                                        <div style={{ display: 'flex', gap: '8px' }}>
                                            <input
                                                type="text"
                                                placeholder="PROMO-CODE-2024"
                                                value={promoCode}
                                                onChange={(e) => setPromoCode(e.target.value.toUpperCase())}
                                                style={{ flex: 1 }}
                                            />
                                            <button
                                                type="button"
                                                className="btn"
                                                style={{
                                                    width: 'auto',
                                                    padding: '12px 24px',
                                                    background: '#2C3E50'
                                                }}
                                            >
                                                Apply
                                            </button>
                                        </div>
                                        <p style={{ fontSize: '12px', color: '#10b981', marginTop: '8px', display: promoCode ? 'block' : 'none' }}>
                                            ‚úì Promo code will be applied at checkout
                                        </p>
                                    </div>
                                )}
                            </div>
                        </div>

                        <button type="submit" className="btn">
                            Pay ${totalAmount} {plan ? '& Get Access' : '& Start Consultation'}
                        </button>
                    </form>

                    <p style={{ textAlign: 'center', fontSize: '12px', color: '#999', marginTop: '16px' }}>
                        üîí Secured by Stripe ¬∑ Your payment information is encrypted
                    </p>
                </div>
            );
        }

        function ConsultationView({ doctor, user, onEndCall }) {
            const [messages, setMessages] = useState([
                { sender: 'System', text: 'Consultation started. Your specialist is ready to help!', isSystem: true },
                { sender: doctor.name, text: `Hello! I'm ${doctor.name}, your neonatal specialist. How can I help you today?`, isDoctor: true }
            ]);
            const [newMessage, setNewMessage] = useState('');
            const [isTyping, setIsTyping] = useState(false);

            const sendMessage = () => {
                if (newMessage.trim()) {
                    setMessages([...messages, { sender: user.name, text: newMessage, isDoctor: false }]);
                    setNewMessage('');
                    setIsTyping(true);
                    
                    // Simulate doctor response
                    setTimeout(() => {
                        setIsTyping(false);
                        const responses = [
                            "I understand your concern. Can you provide more details?",
                            "That's a common question among new parents. Let me explain...",
                            "Based on what you're describing, here's what I recommend...",
                            "Great question! In neonatal care, we typically approach this by..."
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        setMessages(prev => [...prev, { 
                            sender: doctor.name, 
                            text: randomResponse, 
                            isDoctor: true 
                        }]);
                    }, 1500);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            };

            return (
                <div className="card">
                    <div className="app-header">
                        <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                            <img
                                src="https://upload.wikimedia.org/wikipedia/commons/3/36/McDonald%27s_Golden_Arches.svg"
                                alt="McDonald's"
                                className="client-logo-small"
                            />
                            <div className="doctor-avatar" style={{ width: '50px', height: '50px', fontSize: '24px' }}>
                                {doctor.avatar}
                                <div className="online-status"></div>
                            </div>
                            <div>
                                <h2 style={{ marginBottom: '4px', fontSize: '18px', color: 'white' }}>{doctor.name}</h2>
                                <p style={{ color: 'rgba(255,255,255,0.8)', fontSize: '13px', margin: 0 }}>{doctor.specialty}</p>
                            </div>
                        </div>
                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                            <div style={{
                                background: 'rgba(255,255,255,0.15)',
                                padding: '6px 12px',
                                borderRadius: '6px',
                                fontSize: '13px',
                                color: 'white'
                            }}>hoy</div>
                            <span className="status-badge" style={{ background: '#10b981', marginLeft: 0 }}>‚óè LIVE</span>
                        </div>
                    </div>
                    <div style={{ padding: '0 8px' }}>

                    <div style={{
                        background: '#f8f9fa',
                        borderRadius: '8px',
                        height: '500px',
                        display: 'flex',
                        flexDirection: 'column',
                        overflow: 'hidden',
                        marginTop: '20px',
                        border: '1px solid #e5e7eb'
                    }}>
                        <div style={{
                            flex: 1,
                            overflowY: 'auto',
                            padding: '20px',
                            display: 'flex',
                            flexDirection: 'column',
                            gap: '12px'
                        }}>
                            {messages.map((msg, idx) => (
                                <div 
                                    key={idx} 
                                    style={{
                                        display: 'flex',
                                        justifyContent: msg.isDoctor || msg.isSystem ? 'flex-start' : 'flex-end'
                                    }}
                                >
                                    <div style={{
                                        maxWidth: '70%',
                                        background: msg.isSystem ? '#fff3cd' : msg.isDoctor ? 'white' : '#2C3E50',
                                        color: msg.isSystem ? '#856404' : msg.isDoctor ? '#2C3E50' : 'white',
                                        padding: '10px 14px',
                                        borderRadius: msg.isDoctor ? '12px 12px 12px 2px' : msg.isSystem ? '8px' : '12px 12px 2px 12px',
                                        boxShadow: msg.isDoctor ? '0 1px 3px rgba(0,0,0,0.1)' : 'none',
                                        border: msg.isDoctor ? '1px solid #e5e7eb' : 'none'
                                    }}>
                                        {!msg.isSystem && (
                                            <div style={{ 
                                                fontWeight: '600', 
                                                fontSize: '12px', 
                                                marginBottom: '4px',
                                                opacity: 0.8
                                            }}>
                                                {msg.sender}
                                            </div>
                                        )}
                                        <div style={{ fontSize: '15px', lineHeight: '1.5' }}>{msg.text}</div>
                                    </div>
                                </div>
                            ))}
                            {isTyping && (
                                <div style={{ display: 'flex', justifyContent: 'flex-start' }}>
                                    <div style={{
                                        background: 'white',
                                        padding: '12px 16px',
                                        borderRadius: '16px 16px 16px 4px',
                                        boxShadow: '0 2px 8px rgba(0,0,0,0.1)'
                                    }}>
                                        <div style={{ display: 'flex', gap: '4px', alignItems: 'center' }}>
                                            <div className="typing-dot"></div>
                                            <div className="typing-dot"></div>
                                            <div className="typing-dot"></div>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>

                        <div style={{
                            padding: '16px',
                            background: 'white',
                            borderTop: '1px solid #e5e7eb'
                        }}>
                            <div style={{ display: 'flex', gap: '8px', alignItems: 'center' }}>
                                <input
                                    type="text"
                                    placeholder="Escribe aqu√≠..."
                                    value={newMessage}
                                    onChange={(e) => setNewMessage(e.target.value)}
                                    onKeyPress={handleKeyPress}
                                    style={{
                                        flex: 1,
                                        padding: '10px 16px',
                                        border: '1px solid #d1d5db',
                                        borderRadius: '20px',
                                        fontSize: '14px',
                                        background: '#f8f9fa'
                                    }}
                                />
                                <button
                                    onClick={sendMessage}
                                    disabled={!newMessage.trim()}
                                    style={{
                                        width: '40px',
                                        height: '40px',
                                        background: newMessage.trim() ? '#2C3E50' : '#d1d5db',
                                        color: 'white',
                                        border: 'none',
                                        borderRadius: '50%',
                                        cursor: newMessage.trim() ? 'pointer' : 'not-allowed',
                                        fontSize: '18px',
                                        transition: 'all 0.3s',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center'
                                    }}
                                >
                                    ‚û§
                                </button>
                            </div>
                        </div>
                    </div>

                    <button
                        className="btn btn-secondary"
                        style={{ marginTop: '20px' }}
                        onClick={onEndCall}
                    >
                        End Consultation
                    </button>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
